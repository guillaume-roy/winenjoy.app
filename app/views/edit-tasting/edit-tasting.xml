<Page xmlns="http://schemas.nativescript.org/tns.xsd"
    xmlns:vs="components/values-selector"
    xmlns:FAB="nativescript-floatingactionbutton"
    navigatedTo="navigatedTo"
    navigatedFrom="navigatedFrom"
    actionBarHidden="true">
    <GridLayout>
        <TabView id="tab-view">
            <TabView.items>
                <TabViewItem title="Vin">
                    <TabViewItem.view>
                        <ScrollView id="scroll-0">
                            <StackLayout class="tab-view-content">
                                <TextField text="{{ wineTasting.cuvee }}" hint="Cuvée" />
                                <TextField text="{{ wineTasting.estate }}" hint="Domaine" />
                                <Label text="Pays" class="criterias-title" />
                                <Button text="Sélectionner" tap="onSelectCountry" class="white-button" visibility="{{ wineTasting.country ? 'collapse' : 'visible' }}" />
                                <Button text="{{ (wineTasting.country ||{}).label }}" tap="onDeleteCountry" class="white-button" visibility="{{ wineTasting.country ? 'visible' : 'collapse' }}" />
                                <Label text="Région" class="criterias-title" />
                                <Button text="Sélectionner" tap="onSelectRegion" class="white-button" visibility="{{ wineTasting.region ? 'collapse' : 'visible' }}" />
                                <Button text="{{ (wineTasting.region ||{}).label }}" tap="onDeleteRegion" class="white-button" visibility="{{ wineTasting.region ? 'visible' : 'collapse' }}" />
                                <Label text="AOC" class="criterias-title" />
                                <Button text="Sélectionner" tap="onSelectAoc" class="white-button" visibility="{{ wineTasting.aoc ? 'collapse' : 'visible' }}" />
                                <Button text="{{ (wineTasting.region ||{}).label }}" tap="onDeleteAoc" class="white-button" visibility="{{ wineTasting.aoc ? 'visible' : 'collapse' }}" />
                                <Label text="Année" class="criterias-title" />
                                <Button text="Sélectionner" tap="onSelectYear" class="white-button" visibility="{{ wineTasting.year ? 'collapse' : 'visible' }}" />
                                <Button text="{{ wineTasting.year }}" tap="onDeleteYear" class="white-button" visibility="{{ wineTasting.year ? 'visible' : 'collapse' }}" />
                                <Label text="{{ alcoholFormattedValue ? alcoholFormattedValue + '%' : '% Alcool' }}" class="criterias-title-no-margin" width="70" />
                                <Slider id="alcohol-slider" value="{{ alcoholValue }}" minValue="30" maxValue="180" class="criterias-margin" />
                                <Label text="Biologique" class="criterias-title" />
                                <Switch checked="{{ wineTasting.isBiologic }}" />
                                <Label text="Biodynamique" class="criterias-title" />
                                <Switch checked="{{ wineTasting.isBiodynamic }}" />
                                <Label text="Dégustation à l'aveugle" class="criterias-title" />
                                <Switch checked="{{ wineTasting.isBlindTasting }}" />
                                <Label text="Cépages" class="criterias-title" />
                                <Button text="Sélectionner" tap="onSelectGrapes" class="white-button" />
                                <vs:ValuesSelector items="{{ wineTasting.grapes }}" deleteOnClick="true" />
                                <TextView text="{{ wineTasting.wineTabNotes }}" hint="Commentaires" />
                            </StackLayout>
                        </ScrollView>
                    </TabViewItem.view>
                </TabViewItem>
                <TabViewItem title="Aspect">
                    <TabViewItem.view>
                        <ScrollView id="scroll-1">
                            <StackLayout class="tab-view-content">
                                <SegmentedBar selectedIndex="{{ wineTypeSelectedIndex }}">
                                    <SegmentedBar.items>
                                        <SegmentedBarItem title="Blanc" />
                                        <SegmentedBarItem title="Rosé" />
                                        <SegmentedBarItem title="Rouge" />
                                    </SegmentedBar.items>
                                </SegmentedBar>
                                <Button text="Sélectionner la robe" tap="onSelectColor" visibility="{{ wineTasting.color ? 'collpase' : 'visible' }}" class="modal-button" />
                                <Button text="Supprimer la robe" tap="onDeleteColor" color="{{wineTasting.color | foregroundColorConverter}}" backgroundColor="{{wineTasting.color}}" visibility="{{ wineTasting.color ? 'visible' : 'collapse' }}" class="modal-button" />
                                <Label text="Limpidité" class="criterias-title" />
                                <vs:ValuesSelector items="{{ limpidityCriterias }}" selectedItems="{{ wineTasting.limpidities }}" />
                                <Label text="Brillance" class="criterias-title" />
                                <vs:ValuesSelector items="{{ shineCriterias }}" selectedItems="{{ wineTasting.shines }}" />
                                <Label text="Larmes" class="criterias-title" />
                                <vs:ValuesSelector items="{{ tearCriterias }}" selectedItems="{{ wineTasting.tears }}" />
                                <Label text="Bulles" class="criterias-title" />
                                <Switch style="horizontal-align: right" checked="{{ hasBubbles }}" />
                                <vs:ValuesSelector items="{{ bubbleCriterias }}" selectedItems="{{ wineTasting.bubbles }}" visibility="{{ hasBubbles ? 'visible' : 'collapse' }}" />
                                <TextView text="{{ wineTasting.sightTabNotes }}" hint="Commentaires" />
                            </StackLayout>
                        </ScrollView>
                    </TabViewItem.view>
                </TabViewItem>
                <TabViewItem title="Arômes">
                    <TabViewItem.view>
                        <ScrollView id="scroll-2">
                            <StackLayout class="tab-view-content">
                                <Button text="Sélectionner les arômes" tap="onAddAromas" class="modal-button" />
                                <vs:ValuesSelector items="{{ wineTasting.aromas }}" deleteOnClick="true"/>
                                <Button text="Sélectionner les défauts" tap="onAddDefects" class="modal-button" />
                                <vs:ValuesSelector items="{{ wineTasting.defects }}" deleteOnClick="true"/>
                                <Label text="Intensité" class="criterias-title" />
                                <vs:ValuesSelector items="{{ intensityCriterias }}" selectedItems="{{ wineTasting.intensities }}"/>
                                <TextView text="{{ wineTasting.smellTabNotes }}" hint="Commentaires" />
                            </StackLayout>
                        </ScrollView>
                    </TabViewItem.view>
                </TabViewItem>
                <TabViewItem title="Saveurs">
                    <TabViewItem.view>
                        <ScrollView id="scroll-3">
                            <StackLayout class="tab-view-content">
                                <Label text="Attaque" class="criterias-title" />
                                <vs:ValuesSelector items="{{ attackCriterias }}" selectedItems="{{ wineTasting.attacks }}" />
                                <Label text="Equilibre" class="criterias-title" />
                                <vs:ValuesSelector items="{{ tannicCriterias }}" selectedItems="{{ wineTasting.balances }}" visibility="{{ (wineTasting.wineType.code === 'RED' || wineTasting.wineType.code === 'ROSE') ? 'visible' : 'collapse'}}" />
                                <vs:ValuesSelector items="{{ acidityCriterias }}" selectedItems="{{ wineTasting.balances }}" visibility="{{ wineTasting.wineType.code === 'WHITE' ? 'visible' : 'collapse'}}" />
                                <Label text="Finale" class="criterias-title" />
                                <vs:ValuesSelector items="{{ lengthCriterias }}" selectedItems="{{ wineTasting.length }}" />
                                <TextView hint="Commentaires" text="{{ wineTasting.tasteTabNotes }}" />
                            </StackLayout>
                        </ScrollView>
                    </TabViewItem.view>
                </TabViewItem>
                <TabViewItem title="Synthèse">
                    <TabViewItem.view>
                        <ScrollView id="scroll-4">
                            <StackLayout class="tab-view-content">
                                <!--<fr:FinalRating selectedValue="{{ wineTasting.finalRating }}" style="margin-top: 8;horizontal-align: center;" colspan="2" />-->
                                <TextView text="{{ wineTasting.synthesisTabNotes }}" hint="Commentaires" />
                            </StackLayout>
                        </ScrollView>
                    </TabViewItem.view>
                </TabViewItem>
            </TabView.items>
        </TabView>
        <FAB:fab id="fab"
            icon="res://ic_check_white_24dp"
            rippleColor="#f1f1f1"
            class="fab-button"
            tap="saveTasting" />
        <FAB:fab id="fab-delete"
            icon="res://ic_close_white_24dp"
            rippleColor="#f1f1f1"
            visibility="{{ isEditMode ? 'visible' : 'collapse' }}"
            class="fab-button-delete"
            tap="deleteTasting" />
    </GridLayout>
</Page>